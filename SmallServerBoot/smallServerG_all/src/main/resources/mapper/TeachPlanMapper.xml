<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!--一个Mapper一个-->

<mapper namespace="com.slk.dao.TeachPlanMapper">

    <!--科目 = 章节 x N = 小章节 x N-->
    <!--{pname: xxx, id: xx,
            child_1: [{pname: xxx, id: xxx, child:[
                                                {pname:xx, id: xx}, {pname:xx, id: xx}]],
            child_1: [{pname: xxx, id: xxx, child}]}-->

    <!--相当于一对多: 写返回值's 泛型-->
    <resultMap id="teachPlanMap" type="com.slk.domain.TeachPlanNode">
        <id column="one_id" property="id"/>
        <result column="one_name" property="pname"/>
        <collection property="children" ofType="com.slk.domain.TeachPlanNode">
            <id column="two_id" property="id"/>
            <result column="two_name" property="pname"/>
                <collection property="children" ofType="com.slk.domain.TeachPlanNode">
                    <id column="three_id" property="id" />
                    <result column="three_name" property="pname"/>
                </collection>
        </collection>
    </resultMap>
    <select id="findOneNode" resultMap="teachPlanMap">
        select
	a.pname one_name,
	a.id one_id,
	b.pname two_name,
	b.id two_id,
	c.pname three_name,
	c.id three_id

	from teachplan a
	left join teachplan b
	on a.id = b.parentid

	left join teachplan c
	on c.parentid = b.id

	where a.parentid=0
	and a.courseid = '4028e58161bd22e60161bd23672a0001'
    </select>



    <select id="findOne" resultType="com.slk.domain.Teachplan">
        select * from teachplan where id = '4028858162e5d6e00162e5e0227b0000'
    </select>
</mapper>